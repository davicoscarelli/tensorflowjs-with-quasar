(self["webpackChunktensorflowjs_with_quasar"]=self["webpackChunktensorflowjs_with_quasar"]||[]).push([[272],{1949:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>g});var s=i(3673),o=i(2323);const a={class:"resultFrame"},d={style:{display:"block"},ref:"video",autoplay:""},r=["width","height"],l={class:"red"};function n(e,t,i,n,h,c){const m=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(m,{class:"flex flex-center"},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s._)("div",a,[(0,s._)("video",d,null,512),(0,s._)("canvas",{style:{position:"absolute"},ref:"canvas",width:h.resultWidth,height:h.resultHeight},null,8,r)])]),(0,s._)("h1",l,"A"+(0,o.zw)(h.error),1)])),_:1})}i(71),i(7965);var h=i(9548),c=(i(5830),i(1959));i(9935);const m={name:"app",data(){return{streamPromise:null,modelPromise:null,isVideoStreamReady:!1,isModelReady:!1,initFailMessage:"",model:null,baseModel:"lite_mobilenet_v2",selectableModels:["lite_mobilenet_v2","mobilenet_v1","mobilenet_v2"],videoRatio:1,resultWidth:0,resultHeight:0,videoHeight:480,videoWidth:270,error:""}},methods:{initWebcamStream(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(this.error="pelo menos entrou",navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment",width:{min:this.videoWidth,max:this.videoWidth},height:{min:this.videoHeight,max:this.videoHeight}}}).then((e=>{let t=this.$refs.video;try{t.srcObject=e}catch(i){t.src=URL.createObjectURL(e)}return new Promise(((e,i)=>{t.onloadedmetadata=()=>{this.videoRatio=t.offsetHeight/t.offsetWidth,window.addEventListener("resize",this.setResultSize),this.setResultSize(),this.isVideoStreamReady=!0,console.log("webcam stream initialized"),this.error="webcam stream initialized",e()}}))})).catch((e=>{throw console.log("failed to initialize webcam stream",e),this.error="failed to initialize webcam stream",e}))):(this.error="Your browser does not support mediaDevices.getUserMedia API",Promise.reject(new Error("Your browser does not support mediaDevices.getUserMedia API")))},setResultSize(){let e=document.documentElement.clientWidth;this.resultWidth=Math.min(this.videoWidth,e),this.resultHeight=this.resultWidth*this.videoRatio;let t=this.$refs.video;t.width=this.resultWidth,t.height=this.resultHeight},loadModel(){return this.isModelReady=!1,this.model&&this.model.dispose(),h.load(this.baseModel).then((e=>{this.model=e,this.isModelReady=!0,console.log("model loaded")})).catch((e=>{throw console.log("failed to load the model",e),e}))},async detectObjects(){if(!this.isModelReady)return;let e=(0,c.IU)(this.model),t=await e.detect(this.$refs.video);this.renderPredictions(t),requestAnimationFrame((()=>{this.detectObjects()}))},loadModelAndStartDetecting(){this.modelPromise=this.loadModel(),Promise.all([this.streamPromise,this.modelPromise]).then((()=>{this.detectObjects()})).catch((e=>{console.log("Failed to init stream and/or model"),this.initFailMessage=e}))},setVideoOrientation(){let e=window.screen.orientation;e.type.includes("landscape")&&(this.videoHeight=270,this.videoWidth=480)},renderPredictions(e){const t=this.$refs.canvas.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height),e.forEach((e=>{t.beginPath(),t.rect(...e.bbox),t.lineWidth=3,t.strokeStyle="blue",t.fillStyle="blue",t.stroke(),t.shadowColor="white",t.shadowBlur=10,t.font="24px Arial bold",t.fillText(`${e.class}`,e.bbox[0],e.bbox[1]>10?e.bbox[1]-5:10)}))}},mounted(){this.setVideoOrientation(),this.streamPromise=this.initWebcamStream(),this.loadModelAndStartDetecting()}};var u=i(4379),v=i(7518),b=i.n(v);m.render=n;const g=m;b()(m,"components",{QPage:u.Z})},5410:()=>{},8628:()=>{},5042:()=>{}}]);